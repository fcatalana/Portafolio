<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Clientes</title>

<!-- AGREGAR ICONO DE LA MANZANA EN LA PAGINA-->
<link rel="icon" type="image/x-icon"
	href="https://icons.iconarchive.com/icons/mad-science/yellow-submarine/32/APPLE-icon.png" />

<style>
#titulo {
	color: white;
}
</style>
<link href="../static/css/bootstrap.css" rel="stylesheet"
	th:href="@{/css/bootstrap.css}">
</head>
<body>
	<div class="container">
		<br>
		<h3 class="text-center">Postulaci√≥n Productor</h3>
		<hr>
		<br>
		<div class="table-responsive">
			<table class="table table-bordered">
				<thead>
					<tr>
						<th>Cliente</th>
						<th>Productos Solicitados</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="pedido : ${pedidos}" th:if="*{pedido.id} == *{id}">
						<td th:text="${pedido.cliente.nombre_cliente}"></td>
						<td>
							<table class="table table-bordered">
								<thead>
									<tr>
										<th>Nombre</th>
										<th>Cantidad Solicitada (*100 Kg.)</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="producto : ${pedido.productos}">
										<td th:text="${producto.nombre}"></td>
										<td th:text="${producto.cantidad}"></td>
									</tr>
								</tbody>
							</table>
						</td>
					</tr>
				</tbody>
			</table>
		</div>


		<div class="container">
			<h4>Detalle Oferta</h4>
			<form action="#" th:action="@{/addPostulacion}"
				th:object="${pedidoProductor}" method="post" class="row">

				<input type="hidden" class="form-control" id="id" name="id"
					th:value="0"> <input type="hidden" class="form-control"
					id="pedido" name="pedido" required> <input type="hidden"
					class="form-control" id="productor" name="productor"> <input
					type="hidden" class="form-control" id="estado" th:value="Postulado"
					name="estado"> <input type="hidden" class="form-control"
					id="fechaYHora" th:field="*{fechaYHora}" name="fechaYHora" required>

				<div class="form-group col-md-2">
					<label for="calidadFruta">Calidad de la Fruta</label> <select
						th:field="*{calidadFruta}" class="form-select" id="calidadFruta"
						required>
						<option th:each="CalidadFruta:${listCalidadFruta}"
							th:value="${CalidadFruta.id_calidad}"
							th:text="${CalidadFruta.calidad}" />
					</select>
				</div>

				<div class="form-group col-md-4">
					<label for="monto">Costo Total Venta</label> <input type="text"
						class="form-control" id="monto" th:field="*{monto}" name="monto"
						required>
				</div>

				<div>
					<br>
					<button type="submit" class="btn btn-primary">Postular</button>
					<a href="/postulaciones" class="btn btn-danger">Cancelar</a>
				</div>
				<input type="hidden" id="from" name="from"> <input
					type="hidden" id="to" name="to"> <input type="hidden"
					id="subject" name="subject"> <input type="hidden" id="body"
					name="body">
			</form>
			<br> <br> <br> <br>
		</div>


		<div style="display: none">
			<table class="table table-striped table-dark" id="rwd-table-id">
				<thead>
					<tr>
						<th>ID</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="Productor:${listProductor}"
						th:if="*{Productor.usuario.username} == productor2">
						<td th:text="${Productor.id_productor}">
					</tr>
				</tbody>
			</table>
		</div>

		<div style="display: none">
			<table class="table table-striped table-dark" id="rwd1-table1-id">
				<thead>
					<tr>
						<th>usuario</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td sec:authentication="name">
					</tr>
				</tbody>
			</table>
		</div>

		<input type="hidden" class="form-control" id="usuario" name="usuario">

		<input type="hidden" class="form-control" id="asignarId"
			name="asignarId" th:value="*{id}">

		<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
			integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
			crossorigin="anonymous"></script>
		<script
			src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
			integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
			crossorigin="anonymous"></script>
		<script
			src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
			integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
			crossorigin="anonymous"></script>

		<script
			src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	</div>
</body>

<script>
		
		var resume_table = document.getElementById("rwd-table-id");
		
		for (var i = 0, row; row = resume_table.rows[i]; i++) {
  			//alert(cell[i].innerText);
  			for (var j = 0, col; col = row.cells[j]; j++) {
    			//alert(col[j].innerText);
    			var resume=(`${col.innerText}`);
  			}
		}
		
		$('#productor').val(resume);
		
		var resume_table1 = document.getElementById("rwd1-table1-id");
		
		for (var i = 0, row; row = resume_table1.rows[i]; i++) {
  			//alert(cell[i].innerText);
  			for (var j = 0, col; col = row.cells[j]; j++) {
    			//alert(col[j].innerText);
    			var resume1=(`${col.innerText}`);
  			}
		}
		
		$('#usuario').val(resume1);
						
		var resume2 = $('#asignarId').val();  		
		$('#pedido').val(resume2);

</script>
</html>